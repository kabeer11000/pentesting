import {
  saveUserId,
  saveSecretKey,
  getUserName,
  getSecretKey
} from "./cookies";

const AXIOS = require("axios");
const axios = AXIOS.create({
  baseURL: "https://hin0r4g4zi.execute-api.ap-south-1.amazonaws.com/api/"
});

export const createUser = async () => {
  const name = getUserName();

  const result = await axios.post(`/create`, {
    name: name
  });

  if (result) {
    const data = result.data;
    saveUserId(data["userId"]);
    saveSecretKey(data["key"]);
  }
};

export const getMessages = async () => {
  const key = getSecretKey();
  if (key) {
    const result = await axios.get(`/getMessages/${key}`);
    return result ? result.data : undefined;
  }
};

export const getUser = async userId => {
  if (userId) {
    const result = await axios.get(`/getUser/${userId}`);
    return result ? result.data : undefined;
  }
};

export const postMessage = async (userId, message) => {
  await axios.post(`/postMessage/${userId}`, {
    message: message
  });
};

export const deleteMessage = async messageId => {
  await axios.post(`/deleteMessage/${getSecretKey()}/${messageId}`);
};
